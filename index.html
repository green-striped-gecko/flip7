<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Fun Score Tracker</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f7faff;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      text-align: center;
    }

    h1 {
      color: #2c3e50;
      margin-bottom: 20px;
    }

    .player {
      border: 3px solid #ccc;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 15px;
      background: #fff;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      transition: all 0.2s;
      position: relative;
      text-align: left;
    }

    .selected {
      border-color: #3498db;
      background-color: #e8f4fd;
    }

    .score-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .score-line {
      font-size: 24px;
      font-weight: bold;
      margin-top: 5px;
    }

    .queued-points {
      font-size: 16px;
      color: #27ae60;
      margin-top: 5px;
    }

    .add-button {
      background-color: #e17055;
      border: none;
      color: white;
      font-size: 20px;
      padding: 8px 14px;
      border-radius: 10px;
      cursor: pointer;
    }

    .add-button:hover {
      background-color: #d35400;
    }

    .quick-buttons {
      margin-top: 10px;
    }

    .quick-buttons button {
      width: 48px;
      padding: 6px;
      margin: 2px;
      border-radius: 8px;
      background-color: #6c5ce7;
      color: white;
      border: none;
      font-size: 16px;
      transition: background-color 0.2s;
    }

    .quick-buttons button:hover {
      background-color: #4834d4;
    }

    .bottom-buttons {
      margin-top: 30px;
    }

    .bottom-buttons button, .controls button {
      padding: 12px 20px;
      font-size: 16px;
      border-radius: 10px;
      border: none;
      background-color: #00b894;
      color: white;
      margin: 5px;
      cursor: pointer;
    }

    .bottom-buttons button:hover, .controls button:hover {
      background-color: #019875;
    }

    .undo-button {
      background-color: #636e72;
    }

    .undo-button:hover {
      background-color: #2d3436;
    }
  </style>
</head>
<body>

<h1>üéâ Fun Score Tracker üéâ</h1>

<div id="players"></div>

<div class="controls">
  <button class="undo-button" onclick="undo()">‚Ü©Ô∏è Undo</button>
</div>

<div class="bottom-buttons">
  <button onclick="resetAll()">üîÑ Reset All</button>
</div>

<script>
  const numPlayers = 4;
  let scores = Array(numPlayers).fill(0);
  let queues = Array(numPlayers).fill().map(() => []);
  let history = Array(numPlayers).fill().map(() => []);
  let currentPlayer = 0;

  const playersContainer = document.getElementById("players");

  function renderPlayers() {
    playersContainer.innerHTML = '';
    for (let i = 0; i < numPlayers; i++) {
      const playerDiv = document.createElement("div");
      playerDiv.className = "player" + (i === currentPlayer ? " selected" : "");
      playerDiv.id = `player${i}`;
      playerDiv.onclick = () => selectPlayer(i);

      playerDiv.innerHTML = `
        <div class="score-header">
          <strong>Player ${i + 1}</strong>
          <button class="add-button" onclick="applyQueuedToPlayer(event, ${i})">+</button>
        </div>
        <div class="score-line"><span id="score${i}">${scores[i]}</span></div>
        <div class="queued-points" id="queued${i}"></div>
        <div class="quick-buttons">
          ${[...Array(12)].map((_, v) => `<button onclick="queuePoints(event, ${i}, ${v + 1})">${v + 1}</button>`).join('')}
          <button onclick="doubleQueued(event, ${i})">√ó2</button>
        </div>
      `;
      playersContainer.appendChild(playerDiv);
    }
    updateQueuedDisplays();
  }

  function selectPlayer(index) {
    currentPlayer = index;
    renderPlayers();
  }

  function queuePoints(e, player, val) {
    e.stopPropagation();
    queues[player].push(val);
    updateQueuedDisplays();
  }

  function doubleQueued(e, player) {
    e.stopPropagation();
    queues[player] = queues[player].map(p => p * 2);
    updateQueuedDisplays();
  }

  function updateQueuedDisplays() {
    for (let i = 0; i < numPlayers; i++) {
      const q = queues[i];
      const qEl = document.getElementById(`queued${i}`);
      qEl.innerText = q.length > 0 ? `+ ${q.join(' + ')}` : '';
    }
  }

  function applyQueuedToPlayer(e, index) {
    e.stopPropagation();
    const total = queues[index].reduce((a, b) => a + b, 0);
    if (total === 0) return;
    scores[index] += total;
    history[index].push(total);
    queues[index] = [];
    document.getElementById(`score${index}`).innerText = scores[index];
    updateQueuedDisplays();
    currentPlayer = (index + 1) % numPlayers;
    renderPlayers();
  }

  function undo() {
    const last = history[currentPlayer].pop();
    if (last !== undefined) {
      scores[currentPlayer] -= last;
      document.getElementById(`score${currentPlayer}`).innerText = scores[currentPlayer];
    }
  }

  function resetAll() {
    scores = Array(numPlayers).fill(0);
    queues = Array(numPlayers).fill().map(() => []);
    history = Array(numPlayers).fill().map(() => []);
    renderPlayers();
  }

  renderPlayers();
</script>

</body>
</html>
